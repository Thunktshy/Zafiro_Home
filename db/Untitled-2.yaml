Last login: Wed Jul 30 00:43:32 2025 from 169.254.0.1
root@srv899499:~# /opt/mssql-tools18/bin/sqlcmd \
  -S localhost \
  -U Thunksthy \
  -P "eWUmX8owfovKPAR3rWoAww" \
  -i setup_testecom.sql
Sqlcmd: 'setup_testecom.sql': Invalid filename.
root@srv899499:~#  sqlcmd -S localhost -U TiendaAdmin -P 'Ricardoydiego.#4' -C
1> SELECT TABLE_SCHEMA, TABLE_NAME
2> FROM INFORMATION_SCHEMA.TABLES
3> WHERE TABLE_TYPE = 'BASE TABLE'
4> ORDER BY TABLE_SCHEMA, TABLE_NAME;
5> go
TABLE_SCHEMA                                                                                                                     TABLE_NAME                                                                                                                      
-------------------------------------------------------------------------------------------------------------------------------- --------------------------------------------------------------------------------------------------------------------------------
dbo                                                                                                                              MSreplication_options                                                                                                           
dbo                                                                                                                              spt_fallback_db                                                                                                                 
dbo                                                                                                                              spt_fallback_dev                                                                                                                
dbo                                                                                                                              spt_fallback_usg                                                                                                                
dbo                                                                                                                              spt_monitor                                                                                                                     

(5 rows affected)
1> CREATE DATABASE tiendaonline
2> GO
1> USE tiendaonline;
2> go
Changed database context to 'tiendaonline'.
1> ALTER AUTHORIZATION ON DATABASE::tiendaonline TO [Thunktshy];
2> go
1> CREATE USER [Thunktshy] FOR LOGIN [Thunktshy];
2> go
Msg 15405, Level 16, State 1, Server srv899499, Line 1
Cannot use the special principal 'Thunktshy'.
1> CREATE LOGIN [TiendaAdmin]
2> WITH PASSWORD = 'Ricardoydiego.#4',
3> CHECK_POLICY = OFF;
4> go
1> USE tiendaonline;
2> go
Changed database context to 'tiendaonline'.
1> CREATE USER [TiendaAdmin] FOR LOGIN [TiendaAdmin];
2> go
1> ALTER ROLE db_owner ADD MEMBER [TiendaAdmin];
2> go
1> exit
root@srv899499:~# ls
libldap-2.5-0_2.5.13+dfsg-5_amd64.deb  libldap-dev_2.5.13+dfsg-5_amd64.deb
root@srv899499:~# cd /usr
root@srv899499:/usr# ls
bin  games  include  lib  lib64  libexec  local  sbin  share  src
root@srv899499:/usr# cd local
root@srv899499:/usr/local# git --version
git version 2.43.0
root@srv899499:/usr/local# ls
bin  etc  games  include  lib  lsws  man  sbin  share  src
root@srv899499:/usr/local# cd lsws
root@srv899499:/usr/local/lsws# ls
Example   GPL.txt  VERSION  admin        autoupdate  bin        cgid  docs      gdata  logs  lsphp83      modules   php       share
Example2  PLAT     add-ons  adminpasswd  backup      cachedata  conf  fcgi-bin  lib    lsns  lsrecaptcha  password  phpbuild  tmp
root@srv899499:/usr/local/lsws# mkdir serverZafiro
root@srv899499:/usr/local/lsws# cd serverZafiro/
root@srv899499:/usr/local/lsws/serverZafiro# git clone https://github.com/Thunktshy/Zafiro_Home.git
Cloning into 'Zafiro_Home'...
remote: Enumerating objects: 126, done.
remote: Counting objects: 100% (126/126), done.
remote: Compressing objects: 100% (74/74), done.
remote: Total 126 (delta 40), reused 116 (delta 31), pack-reused 0 (from 0)
Receiving objects: 100% (126/126), 601.48 KiB | 9.55 MiB/s, done.
Resolving deltas: 100% (40/40), done.
root@srv899499:/usr/local/lsws/serverZafiro# ls
Zafiro_Home
root@srv899499:/usr/local/lsws/serverZafiro# cd Zafiro_Home/
root@srv899499:/usr/local/lsws/serverZafiro/Zafiro_Home# ls
Protected  Public  Server  Usuarios  db  package-lock.json  package.json  server.js  tesserver.js  testserver.js
root@srv899499:/usr/local/lsws/serverZafiro/Zafiro_Home# vim .env
root@srv899499:/usr/local/lsws/serverZafiro/Zafiro_Home# ls -la
total 176
drwxr-xr-x 8 root root   4096 Aug  9 01:46 .
drwxr-xr-x 3 root root   4096 Aug  9 01:46 ..
-rw-r--r-- 1 root root    156 Aug  9 01:46 .env
drwxr-xr-x 8 root root   4096 Aug  9 01:46 .git
-rw-r--r-- 1 root root     19 Aug  9 01:46 .gitignore
drwxr-xr-x 5 root root   4096 Aug  9 01:46 Protected
drwxr-xr-x 6 root root   4096 Aug  9 01:46 Public
drwxr-xr-x 4 root root   4096 Aug  9 01:46 Server
drwxr-xr-x 5 root root   4096 Aug  9 01:46 Usuarios
drwxr-xr-x 2 root root   4096 Aug  9 01:46 db
-rw-r--r-- 1 root root 106187 Aug  9 01:46 package-lock.json
-rw-r--r-- 1 root root    725 Aug  9 01:46 package.json
-rw-r--r-- 1 root root   7489 Aug  9 01:46 server.js
-rw-r--r-- 1 root root   9123 Aug  9 01:46 tesserver.js
-rw-r--r-- 1 root root   5309 Aug  9 01:46 testserver.js
root@srv899499:/usr/local/lsws/serverZafiro/Zafiro_Home# node tesserver.js
node:internal/modules/cjs/loader:1143
  throw err;
  ^

Error: Cannot find module 'dotenv'
Require stack:
- /usr/local/lsws/serverZafiro/Zafiro_Home/tesserver.js
    at Module._resolveFilename (node:internal/modules/cjs/loader:1140:15)
    at Module._load (node:internal/modules/cjs/loader:981:27)
    at Module.require (node:internal/modules/cjs/loader:1231:19)
    at require (node:internal/modules/helpers:177:18)
    at Object.<anonymous> (/usr/local/lsws/serverZafiro/Zafiro_Home/tesserver.js:2:1)
    at Module._compile (node:internal/modules/cjs/loader:1364:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1422:10)
    at Module.load (node:internal/modules/cjs/loader:1203:32)
    at Module._load (node:internal/modules/cjs/loader:1019:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:128:12) {
  code: 'MODULE_NOT_FOUND',
  requireStack: [ '/usr/local/lsws/serverZafiro/Zafiro_Home/tesserver.js' ]
}

Node.js v18.20.8
root@srv899499:/usr/local/lsws/serverZafiro/Zafiro_Home# npm install
npm warn EBADENGINE Unsupported engine {
npm warn EBADENGINE   package: '@azure-rest/core-client@2.5.0',
npm warn EBADENGINE   required: { node: '>=20.0.0' },
npm warn EBADENGINE   current: { node: 'v18.20.8', npm: '10.8.2' }
npm warn EBADENGINE }
npm warn EBADENGINE Unsupported engine {
npm warn EBADENGINE   package: '@azure/core-auth@1.10.0',
npm warn EBADENGINE   required: { node: '>=20.0.0' },
npm warn EBADENGINE   current: { node: 'v18.20.8', npm: '10.8.2' }
npm warn EBADENGINE }
npm warn EBADENGINE Unsupported engine {
npm warn EBADENGINE   package: '@azure/core-client@1.10.0',
npm warn EBADENGINE   required: { node: '>=20.0.0' },
npm warn EBADENGINE   current: { node: 'v18.20.8', npm: '10.8.2' }
npm warn EBADENGINE }
npm warn EBADENGINE Unsupported engine {
npm warn EBADENGINE   package: '@azure/core-rest-pipeline@1.22.0',
npm warn EBADENGINE   required: { node: '>=20.0.0' },
npm warn EBADENGINE   current: { node: 'v18.20.8', npm: '10.8.2' }
npm warn EBADENGINE }
npm warn EBADENGINE Unsupported engine {
npm warn EBADENGINE   package: '@azure/core-tracing@1.3.0',
npm warn EBADENGINE   required: { node: '>=20.0.0' },
npm warn EBADENGINE   current: { node: 'v18.20.8', npm: '10.8.2' }
npm warn EBADENGINE }
npm warn EBADENGINE Unsupported engine {
npm warn EBADENGINE   package: '@azure/core-util@1.13.0',
npm warn EBADENGINE   required: { node: '>=20.0.0' },
npm warn EBADENGINE   current: { node: 'v18.20.8', npm: '10.8.2' }
npm warn EBADENGINE }
npm warn EBADENGINE Unsupported engine {
npm warn EBADENGINE   package: '@azure/identity@4.10.2',
npm warn EBADENGINE   required: { node: '>=20.0.0' },
npm warn EBADENGINE   current: { node: 'v18.20.8', npm: '10.8.2' }
npm warn EBADENGINE }
npm warn EBADENGINE Unsupported engine {
npm warn EBADENGINE   package: '@azure/logger@1.3.0',
npm warn EBADENGINE   required: { node: '>=20.0.0' },
npm warn EBADENGINE   current: { node: 'v18.20.8', npm: '10.8.2' }
npm warn EBADENGINE }
npm warn EBADENGINE Unsupported engine {
npm warn EBADENGINE   package: '@typespec/ts-http-runtime@0.3.0',
npm warn EBADENGINE   required: { node: '>=20.0.0' },
npm warn EBADENGINE   current: { node: 'v18.20.8', npm: '10.8.2' }
npm warn EBADENGINE }

added 215 packages, and audited 216 packages in 13s

39 packages are looking for funding
  run `npm fund` for details

found 0 vulnerabilities
npm notice
npm notice New major version of npm available! 10.8.2 -> 11.5.2
npm notice Changelog: https://github.com/npm/cli/releases/tag/v11.5.2
npm notice To update run: npm install -g npm@11.5.2
npm notice
root@srv899499:/usr/local/lsws/serverZafiro/Zafiro_Home# npm install -g npm@11.5.2
npm error code EBADENGINE
npm error engine Unsupported engine
npm error engine Not compatible with your version of node/npm: npm@11.5.2
npm error notsup Not compatible with your version of node/npm: npm@11.5.2
npm error notsup Required: {"node":"^20.17.0 || >=22.9.0"}
npm error notsup Actual:   {"npm":"10.8.2","node":"v18.20.8"}
npm error A complete log of this run can be found in: /root/.npm/_logs/2025-08-09T01_47_47_004Z-debug-0.log
root@srv899499:/usr/local/lsws/serverZafiro/Zafiro_Home# sudo apt-get install --only-upgrade nodejs
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
nodejs is already the newest version (18.20.8-1nodesource1).
The following packages were automatically installed and are no longer required:
  linux-headers-6.8.0-60 linux-headers-6.8.0-60-generic linux-image-6.8.0-60-generic linux-modules-6.8.0-60-generic linux-tools-6.8.0-60 linux-tools-6.8.0-60-generic
Use 'sudo apt autoremove' to remove them.
0 upgraded, 0 newly installed, 0 to remove and 25 not upgraded.
root@srv899499:/usr/local/lsws/serverZafiro/Zafiro_Home# node -v
v18.20.8
root@srv899499:/usr/local/lsws/serverZafiro/Zafiro_Home# npm install -g npm@latest
npm error code EBADENGINE
npm error engine Unsupported engine
npm error engine Not compatible with your version of node/npm: npm@11.5.2
npm error notsup Not compatible with your version of node/npm: npm@11.5.2
npm error notsup Required: {"node":"^20.17.0 || >=22.9.0"}
npm error notsup Actual:   {"npm":"10.8.2","node":"v18.20.8"}
npm error A complete log of this run can be found in: /root/.npm/_logs/2025-08-09T01_50_46_309Z-debug-0.log
root@srv899499:/usr/local/lsws/serverZafiro/Zafiro_Home# ls
Protected  Public  Server  Usuarios  db  node_modules  package-lock.json  package.json  server.js  tesserver.js  testserver.js
root@srv899499:/usr/local/lsws/serverZafiro/Zafiro_Home# node tesserver.js
[dotenv@17.2.1] injecting env (6) from .env -- tip: 🛠️  run anywhere with `dotenvx run -- yourcommand`
Servidor corriendo en el puerto 3000
Listening on http://127.0.0.1:3000
Conexión establecida con la base de datos
Error en el login: ReferenceError: sql is not defined
    at /usr/local/lsws/serverZafiro/Zafiro_Home/tesserver.js:120:27
    at Layer.handleRequest (/usr/local/lsws/serverZafiro/Zafiro_Home/node_modules/router/lib/layer.js:152:17)
    at next (/usr/local/lsws/serverZafiro/Zafiro_Home/node_modules/router/lib/route.js:157:13)
    at middleware (/usr/local/lsws/serverZafiro/Zafiro_Home/node_modules/express-validator/lib/middlewares/check.js:16:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
^CShutting down…
/usr/local/lsws/serverZafiro/Zafiro_Home/tesserver.js:265
  if (db?.dbconnector) {
  ^

ReferenceError: db is not defined
    at process.<anonymous> (/usr/local/lsws/serverZafiro/Zafiro_Home/tesserver.js:265:3)
    at process.emit (node:events:517:28)

Node.js v18.20.8
root@srv899499:/usr/local/lsws/serverZafiro/Zafiro_Home# Connection closed
